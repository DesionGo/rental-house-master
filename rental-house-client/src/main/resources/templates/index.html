<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
   <head>
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <meta name="description" content="Webartinfo">
      <meta name="author" content="Webartinfo">
      <title>租房网</title>
      <!-- Favicon Icon -->


   </head>
   <body>
      <!-- Navbar -->
      <header>
         <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container">
               <a class="navbar-brand text-success logo" href="index.html">
               <img class="img-fluid" src="/static/img/agency-list/logo.png" style="width: 200px;height: auto">
               </a>
               <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
                  data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
                  aria-label="Toggle navigation">
               <span class="navbar-toggler-icon"></span>
               </button>
               <div class="collapse navbar-collapse" id="navbarResponsive">
                  <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
                     <li class="nav-item">
                        <a class="nav-link" th:href="@{/}">
                        主页
                        </a>
                     </li>
                     <li class="nav-item dropdown">
                        <a class="nav-link" th:href="@{'/propertiesGrid?current=1'}">
                        出租广场
                     </a>
                     </li>

                     <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownPortfolio" data-toggle="dropdown"
                           aria-haspopup="true" aria-expanded="false">
                        我的账户
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdownPortfolio">
                           <a class="dropdown-item" th:href="@{/userProfile}">用户资料</a>

                           <a class="dropdown-item" th:href="@{'/myProperties?current=1'}">我的财产</a>
                           <a class="dropdown-item" th:href="@{'/favoriteProperties?current=1'}">收藏列表</a>
                           <a class="dropdown-item" th:href="@{/addProperty}">新增出租</a>
                        </div>
                     </li>
                    <!-- <li class="nav-item dropdown">
                        <a class="nav-link" href="about.html">
                           关于我们
                        </a>

                     </li>-->
                  </ul>
                  <div class="my-2 my-lg-0">
                     <ul th:if="${authUserInfo.userName} eq null" class="list-inline main-nav-right">
                        <li class="list-inline-item">
                           <a class="btn btn-link btn-sm" th:href="@{/login}">登陆</a>
                        </li>
                        <li class="list-inline-item">
                           <a class="btn btn-success btn-sm" th:href="@{/register}">注册</a>
                        </li>
                     </ul>
                     <ul th:if="${authUserInfo.userName} ne null"  class="list-inline main-nav-right">
                        <li class="list-inline-item">
                           <a class="btn btn-link btn-sm" th:href="@{/userProfile}">欢迎您,[[${authUserInfo.userName}]]</a>
                        </li>
                        <li class="list-inline-item">
                           <a class="btn btn-success btn-sm" th:href="@{/logout}">退出</a>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </nav>
      </header>
      <!-- End Navbar -->
      <!-- Main Slider With Form -->
      <section class="site-slider">
         <div id="siteslider" class="carousel slide" data-ride="carousel">
            <ol class="carousel-indicators">
               <li data-target="#siteslider" data-slide-to="0" class="active"></li>
               <li data-target="#siteslider" data-slide-to="1"></li>
            </ol>
            <div class="carousel-inner" role="listbox">
               <div class="carousel-item active" style="background-image: url('/static/img/overlay/动态图1.jpg')">
                  <div class="overlay"></div>
               </div>
               <div class="carousel-item" style="background-image: url('/static/img/overlay/动态图2.jpg')">
                  <div class="overlay"></div>
               </div>
            </div>
            <a class="carousel-control-prev" href="#siteslider" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#siteslider" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
            </a>
         </div>
         <div class="slider-form">
            <div class="container">
               <div class="text-center mb-5">
                  <h6 class="subtitle mb-1 mt-0 text-shadow text-dark">来找租友？来找房源？来找公寓？我告诉你，找对了！
                  </h6>
                  <h1 class="display-4 mt-0 font-weight-bold text-shadow">欢迎来到租房网
                  </h1>
               </div>
               <form  action="/propertiesGridScreen" name="blog">

                  <div class="row no-gutters">

                     <div class="col-md-4">

                        <div class="input-group">
                           <div class="input-group-addon" ><i >省</i></div>

                           <select class="form-control select2 no-radius" id ="provinceList" name="province"  onchange="cityForm(this.value)">
                           </select>

                        </div>
                     </div>

                     <div class="col-md-3">
                        <div class="input-group">
                           <div class="input-group-addon"><i >市</i></div>
                           <select class="form-control select2 no-radius" id ="cityList" name="city" onchange="countiesForm(this.value)">
                           </select>
                        </div>
                     </div>
                     <div class="col-md-3" id="counties">
                        <div class="input-group">

                           <div class="input-group-addon"><i >县区</i></div>
                           <select  class="form-control select2 no-radius" id="countiesList" name="counties">

                           </select>
                        </div>
                     </div>
                     <div class="col-md-2">
                     <button type="submit" class="btn btn-success btn-block no-radius font-weight-bold"  onclick="  return check()">查询</button>
                  </div>
                  </div>
               </form>
            </div>
         </div>
      </section>
      <!-- End Main Slider With Form -->
      <!-- Properties by City -->
      <section class="section-padding bg-white">
         <div class="section-title text-center mb-5">
            <h2>城市</h2>
            <p>以下是我们支持的城市.</p>
         </div>
         <div class="container">
            <div class="row">
               <div class="col-lg-3" th:each="city: ${authUserInfo.city}">
                  <div class="card bg-dark text-white card-overlay">
                     <a th:href="@{'/propertiesGridScreen?&province=&counties=&city='+${city.cityName}}">
                        <img class="card-img" th:src="${city.url}" alt="Card image">
                        <div class="card-img-overlay">
                           <h3 class="card-title text-white" th:text="${city.cityName}"></h3>
                           <p class="card-text text-white">[[${city.amount}]]条需求</p>
                        </div>
                     </a>
                  </div>
               </div>

            </div>
         </div>
         <div class="row" th:if="${#lists.isEmpty(authUserInfo.city)}">
            <h3 style="margin-top: 100px">无数据</h3>
         </div>
      </section>
      <!-- End Properties by City -->
      <!-- Properties List -->
      <section class="section-padding">
         <div class="section-title text-center mb-5">
            <h2>推荐</h2>
            <p>以下是根据你所设置的地点推荐</p>
         </div>
         <div class="container">
            <div class="row">
               <div class="col-lg-4 col-md-4" th:each="issue: ${authUserInfo.issue}">
                  <div class="card card-list">
                     <a th:href="@{'/propertySingleGallery?issueId='+${issue.id}}">
                        <span class="badge badge-success">在租</span>
                        <img class="card-img-top" src="/static/img/list/1.png" alt="Card image cap">
                        <div class="card-body">
                           <h5 class="card-title" th:text="${issue.headline}"></h5>
                           <h6 class="card-subtitle mb-2 text-muted"><i class="mdi mdi-home-map-marker"></i> [[${issue.createTime}]],[[${issue.province}]],[[${issue.city}]],[[${issue.county}]]
                           </h6>
                           <div class="review-block-rate">
                              <i class="mdi mdi-star"></i>
                              <i class="mdi mdi-star"></i>
                              <i class="mdi mdi-star"></i>
                              <i class="mdi mdi-star-outline"></i>
                              <i class="mdi mdi-star-outline"></i>
                              <span class="badge-pill badge-success ml-2">3.2</span>
                           </div>
                           <h2 class="text-success mb-0 mt-3">
                              [[${issue.money}]]<small>/月</small>
                           </h2>
                        </div>

                     </a>
                  </div>
               </div>

            </div>

         </div>
         <div class="row" th:if="${#lists.isEmpty(authUserInfo.issue)}">
            <h3 style="margin-top: 100px">无数据</h3>
         </div>
      </section>
      <!-- End Properties List -->
      <!-- Trusted Agents -->


      <!-- Join Team -->
   <!--   <section class="py-5 bg-primary">
         <div class="container">
            <div class="row align-items-center text-center text-md-left">
               <div class="col-md-8">
                  <h2 class="text-white my-2">您受否有问题？咨询下客服吧！  -》</h2>
               </div>
               <div class="col-md-4 text-center text-md-right">
               <button type="button"
                     class="btn btn-light my-2">联系客服</button>
               </div>
            </div>
         </div>
      </section>-->
      <!-- End Join Team -->
      <!-- Footer -->

      <!-- End Footer -->
      <!-- Copyright -->
      <section class="pt-4 pb-4">
         <div class="container">
            <div class="row align-items-center text-center text-md-left">
               <div class="col-md-6">
                  <p class="mt-0 mb-0">© 版权所有 2021 出租房工作室. 版权所有</p>
               </div>
               <div class="col-md-6 text-center text-md-right">
                  <p class="mt-0 mb-0">
                     Made with <i class="mdi mdi-heart text-danger"></i> by
                     <a class="text-dark font-weight-bold" target="_blank" href="http://www.bootstrapmb.com">Webartinfo</a>
                  </p>
               </div>
            </div>
         </div>
      </section>
      <script th:replace="common/base::context"></script>
      <script th:replace="common/base::iconpkcss"></script>
      <script th:replace="common/base::mainjs"></script>
      <script>

         function check(){
            if( document.getElementById('provinceList').value==null||document.getElementById('provinceList').value==''){
               alert("省不能空")

               return false;
            }else{
               if(document.getElementById('cityList').value==null||document.getElementById('cityList').value==''){
                  alert("市区不能空")

                  return false;
               }
               else{
                  return true;
               }
            }

         }

         function cityForm(data){
            console.log(data);
            var city=data;
            kvfKit.aGet(BASE_WEB + 'sys/city?city='+city, function (r) {
               var data=r.data;
               $("#cityList").find("option").remove();
               $("#countiesList").find("option").remove();
               var opt;
               opt=new Option("","");
               document.getElementById('cityList').options.add(opt);
               for (var i = 0; i <= data.length; i++) {
                   opt = new Option(data[i], data[i]);
                  document.getElementById('cityList').options.add(opt);
               }
            });
         }

         function countiesForm(data){
            console.log(data);
            var city= document.getElementById('provinceList').value;
            var counties=data;
            kvfKit.aGet(BASE_WEB + 'sys/counties?city='+city+"&&counties="+counties, function (r) {
               var data=r.data;
               if(JSON.stringify(data) == "[]"){
                  $("#counties").css("display", "none");
               }else{
                  $("#counties").css("display", "inline");
               }
               $("#countiesList").find("option").remove();
               var opt;
               opt=new Option("","");
               document.getElementById('countiesList').options.add(opt);
               for (var i = 0; i <= data.length; i++) {
                  var opt = new Option(data[i], data[i]);
                  document.getElementById('countiesList').options.add(opt);
               }
            });
         }

         //JavaScript代码区域
         layui.use(['element', 'layer', 'laytpl','form'], function(){
            var element = layui.element, laytpl = layui.laytpl, layer = layui.layer,form = layui.form;


            kvfKit.aGet(api.province, function (r) {

               laytpl($('#provinceList').html()).render(r.data, function (html) {
               console.log(r.data)
                  var data=r.data;
                  var option = '';
                  option +="<option value=''></option>";
                  for(var i=0;i<data.length;i++){
                     //循环获取返回值，并组装成html代码
                     option +="<option value='"+data[i]+"'>"+data[i]+"</option>";
                  }
                  $("#provinceList").html("");
                  $("#provinceList").append(option);
               });
            });

         });

      </script>
   </body>
</html>